.PHONY: all deps trade depth user clean help

# é»˜è®¤ç›®æ ‡
all: help

# å®‰è£…ä¾èµ–
deps:
	@echo "ğŸ“¦ Installing Go dependencies..."
	go mod download
	go mod tidy
	@echo "âœ… Dependencies installed"

# è¿è¡Œ trade responder
trade:
	@echo "ğŸš€ Starting Trade Responder..."
	cd trade_responder && go run main.go

# è¿è¡Œ WebSocket Depth å®¢æˆ·ç«¯
depth:
	@echo "ğŸš€ Starting WebSocket Depth Client..."
	cd websocket_depth && go run main.go

# è¿è¡Œ WebSocket User å®¢æˆ·ç«¯
user:
	@echo "ğŸš€ Starting WebSocket User Client..."
	cd websocket_user && go run main.go

# æ„å»ºæ‰€æœ‰ç¨‹åº
build:
	@echo "ğŸ”¨ Building all programs..."
	@mkdir -p bin
	cd trade_responder && go build -o ../bin/trade_responder main.go
	cd websocket_depth && go build -o ../bin/websocket_depth main.go
	cd websocket_user && go build -o ../bin/websocket_user main.go
	@echo "âœ… Build complete. Binaries in ./bin/"

# æ¸…ç†æ„å»ºäº§ç‰©
clean:
	@echo "ğŸ§¹ Cleaning build artifacts..."
	rm -rf bin/
	@echo "âœ… Clean complete"

# æ˜¾ç¤ºå¸®åŠ©
help:
	@echo "=========================================="
	@echo "       Mock Go å®¢æˆ·ç«¯å·¥å…·"
	@echo "=========================================="
	@echo ""
	@echo "å¯ç”¨å‘½ä»¤:"
	@echo "  make deps   - å®‰è£… Go ä¾èµ–"
	@echo "  make trade  - è¿è¡Œ Trade Responder"
	@echo "  make depth  - è¿è¡Œ WebSocket Depth å®¢æˆ·ç«¯"
	@echo "  make user   - è¿è¡Œ WebSocket User å®¢æˆ·ç«¯"
	@echo "  make build  - æ„å»ºæ‰€æœ‰ç¨‹åºåˆ° ./bin/"
	@echo "  make clean  - æ¸…ç†æ„å»ºäº§ç‰©"
	@echo "  make help   - æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯"
	@echo ""
	@echo "ä½¿ç”¨ç¤ºä¾‹:"
	@echo "  make deps         # é¦–æ¬¡ä½¿ç”¨ï¼Œå®‰è£…ä¾èµ–"
	@echo "  make trade        # å¯åŠ¨äº¤æ˜“å“åº”æœåŠ¡"
	@echo "  make depth        # å¯åŠ¨æ·±åº¦ WebSocket å®¢æˆ·ç«¯"
	@echo "  make user         # å¯åŠ¨ç”¨æˆ· WebSocket å®¢æˆ·ç«¯"
	@echo ""
	@echo "æç¤º: å¯ä»¥åœ¨å¤šä¸ªç»ˆç«¯åŒæ—¶è¿è¡Œä¸åŒçš„å‘½ä»¤"
	@echo "=========================================="
